<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head>
    <title>XTerm</title>
  <style type="text/css">
    body {
	    background-color: black;
	    text-align: center;
    }
    
    table {
	    color: white;
	    font: 30px "ModeSeven", "Courier New", "Courier", monospace;
	    text-align: left;
	    border: 0px;
	    border-collapse: collapse;
	    margin-left: auto;
	    margin-right: auto;
	    width: 760px;
    }
    
    td {
    	margin: 0px;
    	padding: 0px;
    }
  </style>
  </head>
  
  <body>
    <table><tr><td>
&nbsp;&nbsp; 10 REM>CXTerm35<br />
&nbsp;&nbsp;&nbsp;90 MODE&87:IFFNB(0,1,0)>5:PRINT"Calli<br />
ng Basic version":CHAIN"BXTerm"<br />
&nbsp; 100 IFFNR(130,0,0)<>&FFFF:PRINT"I/O Pr<br />
ocessor Only":END<br />
&nbsp; 110 OSCLI"FX229,1":OSCLI"FX7,7":OSCLI"<br />
FX8,7":U%=FALSE:h%=&3800:M%=TOP+40:IF!M%<br />
=TRUE:FORA%=M%+8TOM%+8+M%!4-1:VDU?A%:NEX<br />
T:M%=A%<br />
&nbsp; 150 IF!M%=TRUE:FORA%=0TOM%!4-1:A%?&9A0<br />
=M%?(A%+8):NEXT:U%=&9AE:M%=M%+A%+8<br />
&nbsp; 160 IF!M%=TRUE:FORA%=0TOM%!4-1STEP4:A%<br />
!h%=M%!(A%+8):NEXT:M%=M%+A%+8<br />
&nbsp; 170 MODE&80-3*(HIMEM<&8000):HIMEM=h%:I<br />
FU%:A%=78:CALLU%<br />
&nbsp; 180 I%=0:L%=0:ONERRORREPORT:PRINTERL:P<br />
ROCH:END<br />
&nbsp; 190 IFU%=0:OSCLI"BUFFER SERIN":OSCLI"L<br />
OAD _TERM":OSCLI"LOAD _FTP"<br />
&nbsp; 200 m%=h%:o%=h%+3:p%=h%+6:w%=h%+9:PROC<br />
G:`%=&780:q%=&7C0:CALLm%:CLS:E$="0.35":i<br />
%=FALSE:A%=FN_80:ONERRORIFFNM:PROCH:END<br />

&nbsp;&nbsp;230 IFi%:A%=FNN<br />
&nbsp; 240 X%=q%:Y%=X%DIV256:REPEATUNTILFNO(U<br />
SRo%AND&FF):END<br />
&nbsp; 260 DEFFNM:OSCLI"FX3":REPORT:IFERR<128<br />
ANDERR<>17:PRINT" at line ";ERL;<br />
&nbsp; 270 IFc%:c%=FALSE:OSCLI"FX2,1":OSCLI"F<br />
X3,1":PROCB:OSCLI"FX3":*FX2,2<br />
&nbsp; 280 PROCE:PRINT:=INKEY-1<br />
&nbsp; 310 DEFFNO(A%):IFPOS:PRINT<br />
&nbsp; 320 =EVAL("FN_"+STR$~A%)<br />
&nbsp; 330 DEFFN_80:PRINT"XTerm C"E$" 24-Jan-<br />
1998 (C)J.G.Harston":PRINT"f0=Help f1=*C<br />
ommand f2=Baud f5=Download f6=Upload f7=<br />
MODE 7 f8=MODE 0 f9=Exit"':=0<br />
&nbsp; 350 DEFFN_81:OSCLI"FX229":i%=TRUE:REPE<br />
ATINPUTLINE"="A$:OSCLIA$:UNTILA$="":OSCL<br />
I"FX229,1":i%=FALSE:=0<br />
&nbsp; 360 DEFFN_82:INPUT"Baud rate: "A$:IFA$<br />
="":=0<br />
&nbsp; 370 A%=(LN(VALA$DIV75)/LN2):OSCLI"FX7,<br />
"+STR$A%:OSCLI"FX8,"+STR$A%:=0<br />
&nbsp; 380 DEFFN_83:W%=NOTW%:PRINT"Debug: "FN<br />
P(W%):=0<br />
&nbsp; 390 DEFFN_84:J%=(J%EOR&480)EOR(((J%AND<br />
&FF)=0)AND&1000):PRINT"Tx size: ";J%AND&<br />
FFF;" CRC:"FNP((J%AND&1000)<>0):=0<br />
&nbsp; 400 DEFFN_85:PROCM:=0<br />
&nbsp; 410 DEFFN_86:PROCI:=0<br />
&nbsp; 420 DEFFN_87:VDU22,&87:=0<br />
&nbsp; 430 DEFFN_88:VDU22,&83:=0<br />
&nbsp; 440 DEFFN_89:PRINT"Exit":PROCH:=TRUE<br />
&nbsp; 450 DEFFN_8A:=0<br />
&nbsp; 460 DEFFN_8B:=0<br />
&nbsp; 470 DEFFN_8C:=0<br />
&nbsp; 480 DEFFN_8D:=0<br />
&nbsp; 490 DEFFN_8E:=0<br />
&nbsp; 500 DEFFN_8F:=0<br />
&nbsp; 530 DEFFNB(A%,X%,Y%):=((USR&FFF4)AND&F<br />
F00)DIV256<br />
&nbsp; 540 DEFFNR(A%,X%,Y%):=((USR&FFF4)AND&F<br />
FFF00)DIV256<br />
&nbsp; 550 DEFPROCN(A%,C%,D%,N%):?X%=C%:X%!1=<br />
D%:X%!5=N%:X%!9=PTR#C%:CALL&FFD1:ENDPROC<br />
<br />
&nbsp; 560 DEFFND(A$,A%):$`%=A$:?X%=`%:X%?1=`<br />
%DIV256:=(USR&FFDD)AND&FF<br />
&nbsp; 570 DEFPROCH:OSCLI"FX229":OSCLI"FX225,<br />
1":OSCLI"FX2":OSCLI"FX3":PROCE:PROCJ:END<br />
PROC<br />
&nbsp; 580 DEFPROCE:IFI%:A%=I%:I%=0:CLOSE#A%<br />

&nbsp;&nbsp;590 IFL%:A%=L%:L%=0:CLOSE#A%<br />
&nbsp; 600 ENDPROC<br />
&nbsp; 670 DEFPROCG:c%=FALSE:L=2:W%=FALSE:J=&<br />
86:J%=&80:B=0:M=1:N=2:H=4:K=6:O=21:I=24:<br />
Q=26:G=-1:A=1:C=2:D=6:F=12:E=27:DIMO%102<br />
3,A$(7):FORz%=0TO7:READA$(z%):NEXT:ENDPR<br />
OC<br />
&nbsp; 710 DATA Ok,Bad data,No data,Bad seque<br />
nce,Remote abort,Local abort<br />
&nbsp; 720 DATA Can't open file,No signal<br />
&nbsp; 740 DEFFNE:PRINT"(T)ext or (B)inary? "<br />
;:REPEATA%=GETAND&DF:UNTILINSTR("TB",CHR<br />
$A%):VDUA%:=A%=ASC"T"<br />
&nbsp; 750 DEFFNP(A%)=MID$("OFFON",-3*A%+1,3)<br />
<br />
&nbsp; 760 DEFFNI(A%):IFA%<0:="?"ELSE=A%<br />
&nbsp; 770 DEFFNJ(A%):=LEFT$($A%,INSTR($A%,CH<br />
R$0)-1)<br />
&nbsp; 820 DEFPROCA(A$,A%):OSCLI"FX3":PRINTCH<br />
R$6;CHR$13;A$;SPC((9-LENA$)AND(LENA$<10)<br />
)" '"C$"' Pkt ";FNI(G%);": ";FNI(F%);" b<br />
ytes";:IFA%:VDU13:OSCLI"FX3,3":ENDPROC<br />
&nbsp; 830 IFE%>0:t%=100*F%DIVE%:PRINT", ";t%<br />
;"% of ";E%;:t%=j%*(100-t%)DIV(t%+1)DIV1<br />
00:PRINT" ";t%DIV60;":";RIGHT$("0"+STR$(<br />
t%MOD60),2);<br />
&nbsp; 840 PRINT" ";100*F%DIVj%;"c/s "MID$("1<br />
281k",(H%DIV&100),3)"-"MID$("SUMCRC",-3*<br />
Q%+1,3)" "MID$("TIMEOUTOk&nbsp;&nbsp;&nbsp;&nbsp;BadCRCEOT&nbsp;&nbsp;<br />
&nbsp;BadPkt",3*(B%AND-2)+7-(B%>=0),6-(B%<0))<br />
;SPC6;STRING$(15,CHR$8);:OSCLI"FX3,3":EN<br />
DPROC<br />
&nbsp; 890 DEFPROCM:PRINT"XYModem download. "<br />
;:*FX229<br />
&nbsp; 900 INPUT"Destination file/directory: <br />
"B$:d%=FNE:IFd%:PRINT" - Converting inco<br />
ming LF to CR";<br />
&nbsp; 920 OSCLI"FX229,1":PRINT:B%=FNS(B$,d%)<br />
:PRINT:IFB%<>B:PRINT"Download error: ";A<br />
$(B%)<br />
&nbsp; 930 PRINT:ENDPROC<br />
&nbsp;1020 DEFFNS(B$,d%):OSCLI"FX3,3":OSCLI"F<br />
X2,1":Z%=FNB(229,1,0):c%=TRUE:REPEATB%=F<br />
NF:UNTILB%<>B:c%=FALSE:OSCLI"FX3":OSCLI"<br />
FX2,2":Z%=FNB(229,Z%,0):=(B%AND15)DIV2<br />
&nbsp;1120 DEFFNF:F$=B$:C$="":D$="":E%=-1:u%=<br />
-1:v%=-1:G%=-1:H%=-1:Q%=-1:k%=-1:F%=-1:P<br />
%=TIME:j%=1:e%=FALSE:B%=FNA:IFB%<>B:=B%<br />

 1140 IFG%>1:PROCB:=D<br />
&nbsp;1150 IFG%=0:PROCK:e%=TRUE:IFC$="":PROCC<br />
:=A<br />
&nbsp;1160 L%=FNG:IFL%=0:PROCB:=F<br />
&nbsp;1170 P%=TIME:IFG%=0:PROCC:B%=FNA:IFB%<><br />
B:PROCF:PROCB:=B%<br />
&nbsp;1180 K%=1:F%=0:REPEATB%=FNK:UNTILB%<>B:<br />
PROCF:IFB%=H:PROCA("Finishing",FALSE):PR<br />
OCC:B%=B:IFNOTe%:B%=A<br />
&nbsp;1200 =B%<br />
&nbsp;1280 DEFFNA:_%=3*3*3:REPEATPROCA("Negot<br />
iating",FALSE):IF_%MOD3=0:a%=ASCMID$("G"<br />
+CHR$21+"C",(_%DIV3-1)MOD3+1,1):Q%=a%<>2<br />
1:k%=a%=ASC"G"<br />
&nbsp;1310 VDUa%:B%=FNC:IFB%=HORB%=C:PROCD<br />
&nbsp;1320 _%=_%-1:UNTIL_%=0ORB%=IORB%=EORB%=<br />
B:=B%<br />
&nbsp;1410 DEFFNK:IFG%=K%:PROCL:F%=F%+f%:K%=(<br />
K%+1)AND255<br />
&nbsp;1430 PROCA("Receiving",FALSE):IFG%=((K%<br />
-1)AND255):PROCC:=FNH<br />
&nbsp;1440 =D<br />
&nbsp;1500 DEFPROCL:PROCA("Writing",TRUE):f%=<br />
H%:IFE%>=0ANDF%+f%>E%:f%=E%-F%<br />
&nbsp;1520 PROCN(L,L%,O%,f%):ENDPROC<br />
&nbsp;1600 DEFPROCC:IFNOTk%:VDUK<br />
&nbsp;1610 ENDPROC<br />
&nbsp;1660 DEFPROCD:REPEATUNTILINKEY0<0:ENDPR<br />
OC<br />
&nbsp;1730 DEFFNH:R%=3:REPEATB%=FNC:R%=R%-1:U<br />
NTILR%=0OR(B%<>GANDB%<>C)ORk%:=B%<br />
&nbsp;1850 DEFFNC:!J=O%:A%=(d%AND1)OR(Q%AND&8<br />
0):A%=USRp%:j%=TIME-P%:B%=A%AND&FF:IFB%=<br />
B:G%=(A%AND&FF00)DIV256:H%=(A%AND&FF0000<br />
)DIV512<br />
&nbsp;1870 IFB%=E:PROCB<br />
&nbsp;1880 =B%<br />
&nbsp;1910 DEFPROCB:PROCD:PRINTSTRING$(8,CHR$<br />
I);:ENDPROC<br />
&nbsp;1940 DEFPROCK:IF?O%=0:ENDPROC<br />
&nbsp;1950 O%?127=13:C$=FNJ(O%):D$=FNJ(O%+1+L<br />
ENC$):IFD$<>"":E%=VALD$<br />
&nbsp;1980 ENDPROC<br />
&nbsp;2050 DEFFNG:A%=2:IFB$<>"":A%=FND(B$,5):<br />
IFA%=1:IFC$="":C$=B$ELSEIFA%=1:REPEATB$=<br />
LEFT$(B$,LENB$-1):UNTILRIGHT$(B$,1)="."O<br />
RB$="":B$=LEFT$(B$,LENB$-1)<br />
&nbsp;2080 IFC$="":C$="T"+RIGHT$("00000"+STR$<br />
TIME,6)<br />
&nbsp;2100 PROCA("Opening",FALSE):IFE%>=0:X%!<br />
2=0:X%!6=0:X%!10=0:X%!14=E%:A%=FND(B$+LE<br />
FT$(".",B$<>"")+C$,7)<br />
&nbsp;2120 =OPENOUT(B$+LEFT$(".",B$<>"")+C$)<br />

 2180 DEFPROCF:PROCA("Closing",FALSE):CL<br />
OSE#L%:L%=0:IFG%<0:ENDPROC<br />
&nbsp;2200 ENDPROC<br />
&nbsp;2500 DEFPROCI:INPUT"XModem upload file:<br />
&nbsp;"C$:IFC$="":ENDPROC<br />
&nbsp;2510 PRINT"File '"C$"' ";:G%=1:s%=1:F%=<br />
0:V%=0:H%=J%AND&FFF:Q%=(J%AND&1000)<>0:I<br />
%=OPENINC$:IFI%=0:PRINT"not found":ENDPR<br />
OC<br />
&nbsp;2530 E%=EXT#I%:PRINT"is ";1+E%DIVH%;" b<br />
locks":l%=FNE:IFl%:PRINT" - Converting o<br />
utgoing CR to LF";<br />
&nbsp;2550 PRINT:P%=TIME:j%=1:B%=0:T%=0:OSCLI<br />
"FX2,1":*FX3,3<br />
&nbsp;2560 PROCA("Waiting",FALSE):OSCLI"FX229<br />
":REPEATA%=INKEY200:UNTILA%=21OR(A%=ASC"<br />
C"ANDQ%):REPEATPROCA("Waiting",TRUE):IFA<br />
%=0:REPEATA%=INKEY200:UNTILA%=6ORA%=21OR<br />
A%=24<br />
&nbsp;2600 IFA%=24:REPEATA%=INKEY200:UNTILA%=<br />
6ORA%=21ORA%=24<br />
&nbsp;2610 B%=((A%AND&E)DIV2)-((A%=6)AND3):IF<br />
B%=B:V%=V%OR1:F%=PTR#I%:G%=G%+1<br />
&nbsp;2630 j%=TIME-P%:IFV%<>3ANDB%<>4:PROCO<br />
&nbsp;2650 A%=0:UNTILV%=3ORB%>2:PROCA("Finish<br />
ing",0):CLOSE#I%:I%=0:OSCLI"FX3":PRINT'A<br />
$(B%):OSCLI"FX229,1":ENDPROC<br />
&nbsp;2680 DEFPROCO:V%=0:IFEOF#I%ANDT%=0:VDU4<br />
:V%=2:ENDPROC<br />
&nbsp;2690 IFF%+H%>E%:H%=128<br />
&nbsp;2700 PROCA("Sending",0):PTR#I%=F%:g%=0:<br />
FORn%=0TOH%-1:IFT%:b%=T%:T%=0ELSEIFEOF#I<br />
%:b%=26ELSEb%=BGET#I%<br />
&nbsp;2730 IFb%=13ANDl%:b%=10:r%=BGET#I%:PTR#<br />
I%=PTR#I%-1-EOF#I%:IFr%=13:T%=32<br />
&nbsp;2740 g%=FNQ(b%,g%):O%?n%=b%:NEXT:REPEAT<br />
A%=INKEY0:UNTILA%<>21:IFA%<>-1:B%=3:ENDP<br />
ROC<br />
&nbsp;2760 VDUH%DIV1024+1,G%,255-G%:FORn%=0TO<br />
H%-1:VDUO%?n%:NEXT:VDUg%:IFQ%:VDUg%DIV25<br />
6<br />
&nbsp;2790 s%=G%:ENDPROC<br />
&nbsp;2810 DEFFNQ(A%,S%):LOCALz%:IFNOTQ%:=(S%<br />
+A%)AND255<br />
&nbsp;2820 S%=S%EOR(A%*256):FORz%=1TO8:S%=S%*<br />
2:IF(S%AND&10000):S%=S%EOR&1021<br />
&nbsp;2830 NEXT:=S%AND&FFFF<br />
&nbsp;2880 DEFPROCJ:IFU%:A%=!&FFB7:!&22A=A%!&<br />
2A:!&22C=A%!&2C<br />
&nbsp;2890 IFU%=0:*BUFFER OFF<br />
&nbsp;2900 ENDPROC<br />
    </td></tr></table>
  </body>
</html>