<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head>
    <title>CJR Shift Calculator</title>
  <style type="text/css">
    body {
	    background-color: black;
	    text-align: center;
    }
    
    table {
	    color: white;
	    font: 30px "ModeSeven", "Courier New", "Courier", monospace;
	    text-align: left;
	    border: 0px;
	    border-collapse: collapse;
	    margin-left: auto;
	    margin-right: auto;
	    width: 760px;
    }
    
    td {
    	margin: 0px;
    	padding: 0px;
    }
  </style>
  </head>
  
  <body>
    <table><tr><td>
&nbsp;&nbsp; 10 DEFFNS="WorkRo2"<br />
&nbsp;&nbsp;&nbsp;20 MODE7<br />
&nbsp;&nbsp;&nbsp;30 VDU23;8202;0;0;0;<br />
&nbsp;&nbsp;&nbsp;40 *FX4 1<br />
&nbsp;&nbsp;&nbsp;50 READ W%<br />
&nbsp;&nbsp;&nbsp;60 DIM R$(W%,7)<br />
&nbsp;&nbsp;&nbsp;70 DIM D$(7)<br />
&nbsp;&nbsp;&nbsp;80 DIM M$(12)<br />
&nbsp;&nbsp;&nbsp;90 DIM MD%(12)<br />
&nbsp; 100 PROCReadInfo<br />
&nbsp; 250 REPEAT<br />
&nbsp; 260&nbsp;&nbsp; PROCGetDate<br />
&nbsp; 270&nbsp;&nbsp; PROCGetShift<br />
&nbsp; 280&nbsp;&nbsp; VDU28,0,24,39,15<br />
&nbsp; 290&nbsp;&nbsp; A$="."<br />
&nbsp; 300&nbsp;&nbsp; REPEAT<br />
&nbsp; 310&nbsp;&nbsp;&nbsp;&nbsp; VDU12<br />
&nbsp; 320&nbsp;&nbsp;&nbsp;&nbsp; PROCDispWeek<br />
&nbsp; 330&nbsp;&nbsp;&nbsp;&nbsp; PROCAgain<br />
&nbsp; 340&nbsp;&nbsp; UNTILINSTR("AaEe",A$)<br />
&nbsp; 350&nbsp;&nbsp; VDU26<br />
&nbsp; 360 UNTILINSTR("Ee",A$)<br />
&nbsp; 370 END<br />
&nbsp; 380 DEFPROCAgain<br />
&nbsp; 390&nbsp;&nbsp; PRINT'"Ö > < (A)nother (P)rint/(<br />
C)ont (E)nd";<br />
&nbsp; 400&nbsp;&nbsp; *FX21<br />
&nbsp; 410&nbsp;&nbsp; REPEAT<br />
&nbsp; 420&nbsp;&nbsp;&nbsp;&nbsp; A$=GET$<br />
&nbsp; 430&nbsp;&nbsp;&nbsp;&nbsp; IF INSTR("Cc",A$)PROCcont<br />
&nbsp; 440&nbsp;&nbsp;&nbsp;&nbsp; IF INSTR("Pp",A$)PROCPrintOut<br />

&nbsp;&nbsp;450&nbsp;&nbsp; UNTILINSTR(",<.>AaEe",A$)<br />
&nbsp; 460 ENDPROC<br />
&nbsp; 470 DEFPROCcont<br />
&nbsp; 480&nbsp;&nbsp; ONERRORRUN<br />
&nbsp; 490&nbsp;&nbsp; PROCPrintOut<br />
&nbsp; 500&nbsp;&nbsp; REPEAT<br />
&nbsp; 510&nbsp;&nbsp;&nbsp;&nbsp; CLS<br />
&nbsp; 520&nbsp;&nbsp;&nbsp;&nbsp; PROCDispWeek<br />
&nbsp; 530&nbsp;&nbsp;&nbsp;&nbsp; PRINT'TAB(11);"ÖESCAPE TO FINI<br />
SH";<br />
&nbsp; 540&nbsp;&nbsp;&nbsp;&nbsp; PROCPrintOut<br />
&nbsp; 550&nbsp;&nbsp; UNTILFALSE<br />
&nbsp; 560 ENDPROC<br />
&nbsp; 570 DEFPROCPrintOut<br />
&nbsp; 580&nbsp;&nbsp; FORL%=&7E80 TO &7F97 STEP 40<br />
&nbsp; 590&nbsp;&nbsp;&nbsp;&nbsp; FORI%=0 TO 39<br />
&nbsp; 600&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A%=?(L%+I%)<br />
&nbsp; 610&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IF A%<32 OR A%>127 A%=32<br />
&nbsp; 620&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VDU2,1,A%,3<br />
&nbsp; 630&nbsp;&nbsp;&nbsp;&nbsp; NEXT<br />
&nbsp; 640&nbsp;&nbsp;&nbsp;&nbsp; VDU2,1,13,3<br />
&nbsp; 650&nbsp;&nbsp; NEXT<br />
&nbsp; 660 ENDPROC<br />
&nbsp; 670 DEFPROCDispWeek<br />
&nbsp; 680&nbsp;&nbsp; PRINTTAB(9,0);"ÑùÉDate&nbsp;&nbsp;ú ";TAB(<br />
26,0)"ÑùÉDuty&nbsp;&nbsp;ú"<br />
&nbsp; 690&nbsp;&nbsp; FORL%=0TO6<br />
&nbsp; 700&nbsp;&nbsp;&nbsp;&nbsp; IF L%=0:IF INSTR("<,",A$):PROC<br />
DecDay<br />
&nbsp; 710&nbsp;&nbsp;&nbsp;&nbsp; Y$=LEFT$(STR$(Y%)+"00",4)<br />
&nbsp; 720&nbsp;&nbsp;&nbsp;&nbsp; PRINT"Ç";D$(DOW%);TAB(11);STR$<br />
(D%);TAB(14);M$(M%);" ";Y$;TAB(29)"É";R$<br />
(S%,DOW%)<br />
&nbsp; 730&nbsp;&nbsp;&nbsp;&nbsp; PROCIncDay<br />
&nbsp; 740&nbsp;&nbsp; NEXT<br />
&nbsp; 750 ENDPROC<br />
&nbsp; 760 DEFPROCGetShift<br />
&nbsp; 770&nbsp;&nbsp; PROCcent("ÑùÉCalculating "+STR$(<br />
Day%)+" "+M$(Month%)+" "+STR$(Year%)+"&nbsp;&nbsp;<br />
ú")<br />
&nbsp; 780&nbsp;&nbsp; D%=SD%<br />
&nbsp; 790&nbsp;&nbsp; M%=SM%<br />
&nbsp; 800&nbsp;&nbsp; Y%=SY%<br />
&nbsp; 810&nbsp;&nbsp; S%=SS%<br />
&nbsp; 820&nbsp;&nbsp; DOW%=1<br />
&nbsp; 830 IF D%=Day% AND M%=Month% AND Y%=Ye<br />
ar% ENDPROC<br />
&nbsp; 840 REPEAT<br />
&nbsp; 850&nbsp;&nbsp; PROCIncDay<br />
&nbsp; 860 UNTILD%=Day% AND M%=Month% AND Y%=<br />
Year%<br />
&nbsp; 870 ENDPROC<br />
&nbsp; 880 DEFPROCIncDay<br />
&nbsp; 890 D%=D%+1:DOW%=DOW%+1:IF DOW%=8 DOW%<br />
=1:S%=S%+1:IF S%>W% S%=1<br />
&nbsp; 900 IF D%>MD%(M%):PROCchange<br />
&nbsp; 910 ENDPROC<br />
&nbsp; 920 DEFPROCDecDay<br />
&nbsp; 930 FOR I%=1TO14<br />
&nbsp; 940&nbsp;&nbsp; D%=D%-1:DOW%=DOW%-1:IF DOW%=0 DO<br />
W%=7:S%=S%-1:IF S%=0 S%=W%<br />
&nbsp; 950&nbsp;&nbsp; IF D%=0:PROCchangeDown<br />
&nbsp; 960 NEXT<br />
&nbsp; 970 ENDPROC<br />
&nbsp; 980 DEFPROCchange<br />
&nbsp; 990 D%=1<br />
&nbsp;1000 M%=M%+1<br />
&nbsp;1010 IF M%=13:M%=1:Y%=Y%+1<br />
&nbsp;1020 IF Y% MOD 4=0 MD%(2)=29 ELSE MD%(2<br />
)=28<br />
&nbsp;1030 ENDPROC<br />
&nbsp;1040 DEFPROCchangeDown<br />
&nbsp;1050 IF Y% MOD 4=0 MD%(2)=29 ELSE MD%(2<br />
)=28<br />
&nbsp;1060 M%=M%-1<br />
&nbsp;1070 IF M%=0:M%=12:Y%=Y%-1<br />
&nbsp;1080 D%=MD%(M%)<br />
&nbsp;1090 IF Y% MOD 4=0 MD%(2)=29 ELSE MD%(2<br />
)=28<br />
&nbsp;1100 ENDPROC<br />
&nbsp;1110 DEFPROCReadInfo<br />
&nbsp;1120 FORL%=1TO7<br />
&nbsp;1130&nbsp;&nbsp; READD$(L%)<br />
&nbsp;1140 NEXT<br />
&nbsp;1150 FORL%=1TO12<br />
&nbsp;1160&nbsp;&nbsp; READM$(L%),MD%(L%)<br />
&nbsp;1170 NEXT<br />
&nbsp;1180 FORL%=1 TO W%<br />
&nbsp;1190&nbsp;&nbsp; FORI%=1 TO 7<br />
&nbsp;1200&nbsp;&nbsp;&nbsp;&nbsp; READR$(L%,I%):REM READ IN ROTA<br />
<br />
&nbsp;1210&nbsp;&nbsp; NEXT,<br />
&nbsp;1220&nbsp;&nbsp; READ SD%,SM%,SY%,SS%<br />
&nbsp;1230 ENDPROC<br />
&nbsp;1240 DEFPROCGetDate<br />
&nbsp;1250&nbsp;&nbsp; *FX21<br />
&nbsp;1260&nbsp;&nbsp; REPEAT<br />
&nbsp;1270&nbsp;&nbsp;&nbsp;&nbsp; CLS<br />
&nbsp;1280&nbsp;&nbsp;&nbsp;&nbsp; PROCcent("çÅShift Calculator 2<br />
&nbsp;By C.J.Richardson.")<br />
&nbsp;1290&nbsp;&nbsp;&nbsp;&nbsp; PROCcent("çÉShift Calculator 2<br />
&nbsp;By C.J.Richardson.")<br />
&nbsp;1300&nbsp;&nbsp;&nbsp;&nbsp; PRINT<br />
&nbsp;1310&nbsp;&nbsp;&nbsp;&nbsp; PROCcent("ÑùÉWhen to Ring 8BS <br />
on 01482 896868. ú")<br />
&nbsp;1320&nbsp;&nbsp;&nbsp;&nbsp; PRINT<br />
&nbsp;1330&nbsp;&nbsp;&nbsp;&nbsp; PROCcent("ÑùÉEnter Date to Sea<br />
rch For. ú")<br />
&nbsp;1340&nbsp;&nbsp;&nbsp;&nbsp; PRINT''<br />
&nbsp;1350&nbsp;&nbsp;&nbsp;&nbsp; PROCcent("ÜUse any of the foll<br />
owing formats:")<br />
&nbsp;1360&nbsp;&nbsp;&nbsp;&nbsp; PROCcent("Ü"+STR$(SD%)+"/"+STR<br />
$(SM%)+"/"+STR$(SY%)+" or "+STR$(SD%)+".<br />
"+STR$(SM%)+"."+STR$(SY%)+" or "+STR$(SD<br />
%)+" "+STR$(SM%)+" "+STR$(SY%))<br />
&nbsp;1370&nbsp;&nbsp;&nbsp;&nbsp; INPUT'"Ç";D$<br />
&nbsp;1380&nbsp;&nbsp;&nbsp;&nbsp; VDU11<br />
&nbsp;1390&nbsp;&nbsp;&nbsp;&nbsp; Day%=VAL(LEFT$(D$,INSTR(D$," .<br />
/")-1))<br />
&nbsp;1400&nbsp;&nbsp;&nbsp;&nbsp; Year%=VAL(RIGHT$(D$,4))<br />
&nbsp;1410&nbsp;&nbsp;&nbsp;&nbsp; Month%=VAL(MID$(D$,LEN(STR$(Da<br />
y%))+2,LEN(STR$(Year%))))<br />
&nbsp;1420&nbsp;&nbsp; UNTILYear%>=SY% AND Day%>0 AND D<br />
ay%<32 AND Month%>0 AND Month%<13<br />
&nbsp;1430&nbsp;&nbsp; IF Year%>SY%+4 OR Year%<SY% PROC<br />
cent("ÉThis calculation is going to be w<br />
rong!"):PROCcent("ÉI may not be on this <br />
shift pattern."):PRINT<br />
&nbsp;1440 ENDPROC<br />
&nbsp;1450 DEFPROCcent(F$)<br />
&nbsp;1460&nbsp;&nbsp; PRINTTAB(20-LEN(F$)/2);F$<br />
&nbsp;1470 ENDPROC<br />
&nbsp;1720 DATA 10<br />
&nbsp;1730 DATA Monday,Tuesday,Wednesday,Thur<br />
sday,Friday,Saturday,Sunday<br />
&nbsp;1740 DATA January,31,February,28,March,<br />
31,April,30,May,31,June,30,July,31,Augus<br />
t,31,September,30,October,31,November,30<br />
,December,31<br />
&nbsp;1760 DATA 0600-1800,0700-1800,1800-0600<br />
,1800-0600,Off,Off,Off<br />
&nbsp;1770 DATA Off,Off,Off,Off,Off,0600-1800<br />
,0600-1800<br />
&nbsp;1780 DATA Float 1,Float 1,Float 1,Float<br />
&nbsp;1,Float 1,Float 1,Float 1<br />
&nbsp;1790 DATA 1800-0600,1800-0600,Off,Off,1<br />
800-0600,1800-0600,1800-0600<br />
&nbsp;1800 DATA Off,Off,0700-1800,0700-1800,0<br />
700-1800,Off,Off<br />
&nbsp;1810 DATA 0600-1800,0700-1800,1800-0600<br />
,1800-0600,Off,Off,Off<br />
&nbsp;1820 DATA Off,Off,Off,Off,Off,0600-1800<br />
,0600-1800<br />
&nbsp;1830 DATA Float 2,Float 2,Float 2,Float<br />
&nbsp;2,Float 2,Float 2,Float 2<br />
&nbsp;1840 DATA 1800-0600,1800-0600,Off,Off,1<br />
800-0600,1800-0600,1800-0600<br />
&nbsp;1850 DATA Off,Off,0700-1800,0700-1800,0<br />
700-1800,Off,Off<br />
&nbsp;1860 REM DAY,MONTH,YEAR 4 FIG<br />
&nbsp;1870 DATA 6,10,1997<br />
&nbsp;1890 DATA 3<br />
    </td></tr></table>
  </body>
</html>